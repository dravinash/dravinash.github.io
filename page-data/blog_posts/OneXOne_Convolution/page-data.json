{"componentChunkName":"component---src-templates-post-js","path":"/blog_posts/OneXOne_Convolution","result":{"data":{"markdownRemark":{"html":"<h2>Overview</h2>\n<p>Recently while I was reading about the Self Attention Model that was used over images. I heard about this term, 1x1 convolutions. It was being used in calculating the Key, Query and Value. I first find it funny but when I went deeper to understand this guy. I was impressed.\r\nI crafted a three step process to understand this concept. What is 1x1 convolution, why it is useful and where all the places it is utilized.</p>\n<h3>What is 1x1 convolution</h3>\n<h4>Some Background on Convolution Operation</h4>\n<p>Well in order to understand the 1x1 convolution, we need to first understand the convolution operation and the complexity involved in the underlaying operation that it uses.</p>\n<p>Let's say we have a RGB image of dimension 6x6x3 and we want to apply a convolution layer having filter size 3x3, number of filters as 2, activation function as ReLU. Lets say this produces the output that is represented by 'O'. The mathematical equation to understand this is given below. The filter is represent by 'F' while the super script shows the Filter number the sub script denotes the input channel.\r\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/17fc3b7753c6d02aedf1d16a0336bcc2/7a411/CNN-1.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.42857142857143%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIDBf/EABYBAQEBAAAAAAAAAAAAAAAAAAEAAv/aAAwDAQACEAMQAAABw6QYgQ0f/8QAGBAAAgMAAAAAAAAAAAAAAAAAAAEQEUH/2gAIAQEAAQUCLG4w/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQIBAT8BV//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABkQAAIDAQAAAAAAAAAAAAAAAAABESExkf/aAAgBAQABPyGaiDKosFpL6Hp//9oADAMBAAIAAwAAABCEz//EABYRAQEBAAAAAAAAAAAAAAAAAAEAIf/aAAgBAwEBPxB0gL//xAAXEQEBAQEAAAAAAAAAAAAAAAABABEh/9oACAECAQE/EM6Sr//EABkQAQEBAQEBAAAAAAAAAAAAAAERACFBMf/aAAgBAQABPxC2VHkymfJwZ8dV077nDizrnS3/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"CNN 1\"\n        title=\"CNN 1\"\n        src=\"/static/17fc3b7753c6d02aedf1d16a0336bcc2/03346/CNN-1.jpg\"\n        srcset=\"/static/17fc3b7753c6d02aedf1d16a0336bcc2/71299/CNN-1.jpg 175w,\n/static/17fc3b7753c6d02aedf1d16a0336bcc2/1e9fe/CNN-1.jpg 350w,\n/static/17fc3b7753c6d02aedf1d16a0336bcc2/03346/CNN-1.jpg 700w,\n/static/17fc3b7753c6d02aedf1d16a0336bcc2/c3223/CNN-1.jpg 1050w,\n/static/17fc3b7753c6d02aedf1d16a0336bcc2/da6ee/CNN-1.jpg 1400w,\n/static/17fc3b7753c6d02aedf1d16a0336bcc2/7a411/CNN-1.jpg 2048w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\r\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/94bd70374297ec4315a83015f7690229/ea27d/CNN-2.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.28571428571428%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAECAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHDdchCD//EABcQAAMBAAAAAAAAAAAAAAAAAAABEBH/2gAIAQEAAQUCqNn/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAZEAADAQEBAAAAAAAAAAAAAAAAAREhMVH/2gAIAQEAAT8hmptLfCZwSzToiFh//9oADAMBAAIAAwAAABAzz//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/EKf/xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPxCH/8QAGxABAAIDAQEAAAAAAAAAAAAAAQARIUFhoTH/2gAIAQEAAT8QEgBBN+DU1mex16jcM/E9gzRP/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"CNN 2\"\n        title=\"CNN 2\"\n        src=\"/static/94bd70374297ec4315a83015f7690229/03346/CNN-2.jpg\"\n        srcset=\"/static/94bd70374297ec4315a83015f7690229/71299/CNN-2.jpg 175w,\n/static/94bd70374297ec4315a83015f7690229/1e9fe/CNN-2.jpg 350w,\n/static/94bd70374297ec4315a83015f7690229/03346/CNN-2.jpg 700w,\n/static/94bd70374297ec4315a83015f7690229/c3223/CNN-2.jpg 1050w,\n/static/94bd70374297ec4315a83015f7690229/da6ee/CNN-2.jpg 1400w,\n/static/94bd70374297ec4315a83015f7690229/ea27d/CNN-2.jpg 1580w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\r\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/427eb51b605864ebf7ceac49131aa999/755c4/CNN-3.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 135.42857142857144%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAbABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHhWUwozRYE/8QAFxAAAwEAAAAAAAAAAAAAAAAAAAEgEf/aAAgBAQABBQIyG7//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAUEAEAAAAAAAAAAAAAAAAAAAAw/9oACAEBAAY/Ak//xAAcEAACAgIDAAAAAAAAAAAAAAAAARExECEgYZH/2gAIAQEAAT8hS0UsagThE9GyveLx/9oADAMBAAIAAwAAABA8z7D/xAAWEQADAAAAAAAAAAAAAAAAAAABESD/2gAIAQMBAT8QRj//xAAVEQEBAAAAAAAAAAAAAAAAAAARIP/aAAgBAgEBPxAj/8QAHhABAAICAwADAAAAAAAAAAAAAQARITFBUXFhgZH/2gAIAQEAAT8QfkVXcs0pfVy8ZGziOGNfPH5DHtzkzAdLBH1PqO4ODyJAzuLe5//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"CNN 3\"\n        title=\"CNN 3\"\n        src=\"/static/427eb51b605864ebf7ceac49131aa999/03346/CNN-3.jpg\"\n        srcset=\"/static/427eb51b605864ebf7ceac49131aa999/71299/CNN-3.jpg 175w,\n/static/427eb51b605864ebf7ceac49131aa999/1e9fe/CNN-3.jpg 350w,\n/static/427eb51b605864ebf7ceac49131aa999/03346/CNN-3.jpg 700w,\n/static/427eb51b605864ebf7ceac49131aa999/c3223/CNN-3.jpg 1050w,\n/static/427eb51b605864ebf7ceac49131aa999/755c4/CNN-3.jpg 1167w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\r\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c449ab3257e394888aecf0bfcc9d19ef/f7a52/CNN-4.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 101.14285714285714%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAeHcUyozQgP/xAAYEAACAwAAAAAAAAAAAAAAAAAAARARIP/aAAgBAQABBQKGIvP/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAUEAEAAAAAAAAAAAAAAAAAAAAw/9oACAEBAAY/Ah//xAAZEAADAQEBAAAAAAAAAAAAAAAAAREQQSH/2gAIAQEAAT8hvgmxIxoUN18zmf/aAAwDAQACAAMAAAAQFBjA/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAEREP/aAAgBAwEBPxCMgs//xAAVEQEBAAAAAAAAAAAAAAAAAAARIP/aAAgBAgEBPxAj/8QAHBABAAICAwEAAAAAAAAAAAAAAQARITFBUeGx/9oACAEBAAE/ECw+X7NirrJb7EocRMyu5yARrlDBTUWFuf/Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"CNN 4\"\n        title=\"CNN 4\"\n        src=\"/static/c449ab3257e394888aecf0bfcc9d19ef/03346/CNN-4.jpg\"\n        srcset=\"/static/c449ab3257e394888aecf0bfcc9d19ef/71299/CNN-4.jpg 175w,\n/static/c449ab3257e394888aecf0bfcc9d19ef/1e9fe/CNN-4.jpg 350w,\n/static/c449ab3257e394888aecf0bfcc9d19ef/03346/CNN-4.jpg 700w,\n/static/c449ab3257e394888aecf0bfcc9d19ef/c3223/CNN-4.jpg 1050w,\n/static/c449ab3257e394888aecf0bfcc9d19ef/da6ee/CNN-4.jpg 1400w,\n/static/c449ab3257e394888aecf0bfcc9d19ef/f7a52/CNN-4.jpg 1477w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\r\nLets validate these numbers such as output feature map dimension and the number of learning parameter by implementing the same example in tensorflow.</p>\n<div class=\"gatsby-code-title\">Conv2D.py</div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> tensorflow <span class=\"token keyword\">as</span> tf\r\n<span class=\"token keyword\">from</span> tensorflow<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>models <span class=\"token keyword\">import</span> Sequential\r\n<span class=\"token keyword\">from</span> tensorflow<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers <span class=\"token keyword\">import</span> Conv2D\r\n\r\n<span class=\"token comment\"># Define the model</span>\r\nmodel <span class=\"token operator\">=</span> Sequential<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token comment\"># Add a 2D convolution layer</span>\r\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">(</span>filters<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> kernel_size<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">,</span> input_shape<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token comment\"># Summary of the model</span>\r\nmodel<span class=\"token punctuation\">.</span>summary<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>The output of the network is displayed below.\r\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/93a3a0c8a10ceae2ff6db5c235956606/a14f6/CNN-5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.285714285714285%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABJ0AAASdAHeZh94AAAApElEQVQY05WOuQ6EMBBDU0MFiEMhCBBHEm4F/v/XvPJIbLXNFpaTmRc7ap5nTNOEZVnAc57nKMsSRVGItNZY11UYet/3X4ZujMG2bRiGQe7Ke4/rumQYQsC+76jrGk3TCMyA53lAjoUsZjgZijNrrbBVVUF1XYe2bTGOoziD2JQkCdI0RZZlP8Xdu3+dbxQb+cP7vnGeJ47jgHNO2uI4RhRFf+kDoHtpvp02kaMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"CNN 5\"\n        title=\"CNN 5\"\n        src=\"/static/93a3a0c8a10ceae2ff6db5c235956606/39600/CNN-5.png\"\n        srcset=\"/static/93a3a0c8a10ceae2ff6db5c235956606/1aaec/CNN-5.png 175w,\n/static/93a3a0c8a10ceae2ff6db5c235956606/98287/CNN-5.png 350w,\n/static/93a3a0c8a10ceae2ff6db5c235956606/39600/CNN-5.png 700w,\n/static/93a3a0c8a10ceae2ff6db5c235956606/a14f6/CNN-5.png 797w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h4>Challenges with normal convolution filters</h4>\n<blockquote>\n<ol>\n<li>Reduces the feature dimension</li>\n</ol>\n</blockquote>\n<p>This is the</p>\n<blockquote>\n<ol start=\"2\">\n<li>High Complexity</li>\n<li>Lacking in adding the non-linearity</li>\n</ol>\n</blockquote>\n<h4>What is 1x1 convolution</h4>\n<h3>1x1 Applications</h3>","frontmatter":{"title":"1x1 Convolution","description":"Why does someone use a 1x1 convolution? And why is it called 1x1? It sounds like a pixel-sized joke! When it first showed up, people probably thought it was a prank. But hold on, let's dive deep into this mysterious little guy and unravel the math magic behind it.","date":"2024-07-11","slug":"/blog_posts/OneXOne_Convolution","tags":["CNN","TensorFlow"]}}},"pageContext":{}},"staticQueryHashes":["3115057458"]}